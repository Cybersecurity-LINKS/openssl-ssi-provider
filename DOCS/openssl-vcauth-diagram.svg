<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1973px" preserveAspectRatio="none" style="width:1680px;height:1973px;" version="1.1" viewBox="0 0 1680 1973" width="1680px" zoomAndPan="magnify"><defs><filter height="300%" id="fsfgj8hg35e4m" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="212.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="93.5625"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="149.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="405.8906"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="314.7617" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="675.0859"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="142.0977" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1004" y="122.6953"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1004" y="477.1563"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="161.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1004" y="728.3516"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1321" y="151.8281"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="259.1953" style="stroke: #000000; stroke-width: 2.0;" width="1135.5" x="283" y="55.2969"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="216.0625" style="stroke: #000000; stroke-width: 2.0;" width="1021" x="57" y="367.625"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="388.7266" style="stroke: #000000; stroke-width: 2.0;" width="1656" x="13" y="636.8203"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="243.9297" style="stroke: #000000; stroke-width: 2.0;" width="1113" x="546" y="690.0859"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="447.9922" style="stroke: #000000; stroke-width: 2.0;" width="1367.5" x="61" y="1078.6797"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="318.3281" style="stroke: #000000; stroke-width: 2.0;" width="872.5" x="546" y="1131.9453"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="336.1953" style="stroke: #000000; stroke-width: 2.0;" width="1077" x="283" y="1579.8047"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="102.3984" style="stroke: #000000; stroke-width: 2.0;" width="804" x="546" y="1633.0703"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="102.3984" style="stroke: #000000; stroke-width: 2.0;" width="728" x="546" y="1792.6016"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="335" x2="335" y1="38.2969" y2="1933"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="604" x2="604" y1="38.2969" y2="1933"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1009" x2="1009" y1="38.2969" y2="1933"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1325.5" x2="1325.5" y1="38.2969" y2="1933"/><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="293" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="300" y="22.9951">GENPKEY</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="80" x="293" y="1932"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="300" y="1951.9951">GENPKEY</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="556" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="563" y="22.9951">LIBCRYPTO</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="556" y="1932"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="563" y="1951.9951">LIBCRYPTO</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="950" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="957" y="22.9951">SSI_PROVIDER</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="950" y="1932"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="957" y="1951.9951">SSI_PROVIDER</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="1243.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="147" x="1250.5" y="22.9951">IDENTITY_CBINDINGS</text><rect fill="#FEFECE" filter="url(#fsfgj8hg35e4m)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="1243.5" y="1932"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="147" x="1250.5" y="1951.9951">IDENTITY_CBINDINGS</text><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="212.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="93.5625"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="149.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="405.8906"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="314.7617" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="675.0859"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="142.0977" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1004" y="122.6953"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1004" y="477.1563"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="161.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1004" y="728.3516"/><rect fill="#FFFFFF" filter="url(#fsfgj8hg35e4m)" height="71.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1321" y="151.8281"/><path d="M283,55.2969 L448,55.2969 L448,62.2969 L438,72.2969 L283,72.2969 L283,55.2969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="259.1953" style="stroke: #000000; stroke-width: 2.0;" width="1135.5" x="283" y="55.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="298" y="68.3638">PROVIDER LOAD</text><polygon fill="#A80036" points="587,89.5625,597,93.5625,587,97.5625,591,93.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="593" y1="93.5625" y2="93.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="342" y="88.4966">OSSL_PROVIDER_load()</text><polygon fill="#A80036" points="992,118.6953,1002,122.6953,992,126.6953,996,122.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="998" y1="122.6953" y2="122.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="616" y="117.6294">OSSL_PROVIDER_init()</text><polygon fill="#A80036" points="1309,147.8281,1319,151.8281,1309,155.8281,1313,151.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1315" y1="151.8281" y2="151.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="1021" y="146.7622">prov_init_wallet()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1331" x2="1373" y1="180.9609" y2="180.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1373" x2="1373" y1="180.9609" y2="193.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1332" x2="1373" y1="193.9609" y2="193.9609"/><polygon fill="#A80036" points="1342,189.9609,1332,193.9609,1342,197.9609,1338,193.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="1338" y="175.895">setup</text><polygon fill="#A80036" points="1025,219.0938,1015,223.0938,1025,227.0938,1021,223.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1019" x2="1325" y1="223.0938" y2="223.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="1031" y="218.0278">return *wallet</text><polygon fill="#A80036" points="620,260.793,610,264.793,620,268.793,616,264.793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="614" x2="1008" y1="264.793" y2="264.793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="626" y="259.7271">return *provctx</text><path d="M320,236.0938 L320,276.0938 L590,276.0938 L590,246.0938 L580,236.0938 L320,236.0938 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M580,236.0938 L580,246.0938 L590,246.0938 L580,236.0938 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="326" y="253.1606">provctx is now stored in libctx which</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="326" y="268.2935">can be accessed during the application</text><polygon fill="#A80036" points="346,302.4922,336,306.4922,346,310.4922,342,306.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="603" y1="306.4922" y2="306.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="352" y="301.4263">return</text><path d="M444,326.4922 L444,351.4922 L1164,351.4922 L1164,336.4922 L1154,326.4922 L444,326.4922 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1154,326.4922 L1154,336.4922 L1164,336.4922 L1154,326.4922 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="699" x="450" y="343.5591">given the algorithm name (VC) we save into the EVP_PKEY_CTX the provider that contains this implemenation</text><path d="M57,367.625 L273,367.625 L273,374.625 L263,384.625 L57,384.625 L57,367.625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="216.0625" style="stroke: #000000; stroke-width: 2.0;" width="1021" x="57" y="367.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="72" y="380.6919">EVP_PKEY_CTX CREATE</text><polygon fill="#A80036" points="587,401.8906,597,405.8906,587,409.8906,591,405.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="593" y1="405.8906" y2="405.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="342" y="400.8247">EVP_PKEY_CTX_new_from_name("VC")</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="651" y1="435.0234" y2="435.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651" x2="651" y1="435.0234" y2="448.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="610" x2="651" y1="448.0234" y2="448.0234"/><polygon fill="#A80036" points="620,444.0234,610,448.0234,620,452.0234,616,448.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="616" y="429.9575">EVP_KEYMGMT_fetch()</text><polygon fill="#A80036" points="992,473.1563,1002,477.1563,992,481.1563,996,477.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="998" y1="477.1563" y2="477.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="616" y="472.0903">ssi_query()</text><polygon fill="#A80036" points="620,502.2891,610,506.2891,620,510.2891,616,506.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="614" x2="1008" y1="506.2891" y2="506.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="626" y="501.2231">return *vc_kmgmt</text><polygon fill="#A80036" points="346,551.5547,336,555.5547,346,559.5547,342,555.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="603" y1="555.5547" y2="555.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="352" y="550.4888">return *evp_pkey_ctx</text><path d="M67,519.2891 L67,574.2891 L326,574.2891 L326,529.2891 L316,519.2891 L67,519.2891 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M316,519.2891 L316,529.2891 L326,529.2891 L316,519.2891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="73" y="536.356">No we a have an EVP_PKEY_CTX that</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="73" y="551.4888">contains the implementation of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="73" y="566.6216">VC algorithm</text><path d="M444,595.6875 L444,620.6875 L1164,620.6875 L1164,605.6875 L1154,595.6875 L444,595.6875 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1154,595.6875 L1154,605.6875 L1164,605.6875 L1154,595.6875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="699" x="450" y="612.7544">We generate the VC_GEN_CTX in which we will store the Wallet that will be needed to generate a DID and a VC</text><path d="M13,636.8203 L212,636.8203 L212,643.8203 L202,653.8203 L13,653.8203 L13,636.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="388.7266" style="stroke: #000000; stroke-width: 2.0;" width="1656" x="13" y="636.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="28" y="649.8872">VC_GEN_CTX CREATE</text><polygon fill="#A80036" points="587,671.0859,597,675.0859,587,679.0859,591,675.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="593" y1="675.0859" y2="675.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="342" y="670.02">EVP_PKEY_gen_init(*evp_pkey_ctx)</text><path d="M546,690.0859 L674,690.0859 L674,697.0859 L664,707.0859 L546,707.0859 L546,690.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="243.9297" style="stroke: #000000; stroke-width: 2.0;" width="1113" x="546" y="690.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="561" y="703.1528">KMGMT_OP</text><polygon fill="#A80036" points="992,724.3516,1002,728.3516,992,732.3516,996,728.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="998" y1="728.3516" y2="728.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="616" y="723.2856">gen_init(evp_pkey_ctx-&gt;vc_kmgmt)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1056" y1="757.4844" y2="757.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1056" x2="1056" y1="757.4844" y2="770.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1015" x2="1056" y1="770.4844" y2="770.4844"/><polygon fill="#A80036" points="1025,766.4844,1015,770.4844,1025,774.4844,1021,770.4844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1021" y="752.4185">vc_gen_ctx = malloc()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1056" y1="799.6172" y2="799.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1056" x2="1056" y1="799.6172" y2="812.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1015" x2="1056" y1="812.6172" y2="812.6172"/><polygon fill="#A80036" points="1025,808.6172,1015,812.6172,1025,816.6172,1021,812.6172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="293" x="1021" y="794.5513">w = prov_ctx_get_wallet(vc_kmgmt-&gt;provctx)</text><path d="M1326,784.9844 L1326,809.9844 L1635,809.9844 L1635,794.9844 L1625,784.9844 L1326,784.9844 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1625,784.9844 L1625,794.9844 L1635,794.9844 L1625,784.9844 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="1332" y="802.0513">extracts the wallet and saves it in vc_gen_ctx</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1056" y1="841.75" y2="841.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1056" x2="1056" y1="841.75" y2="854.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1015" x2="1056" y1="854.75" y2="854.75"/><polygon fill="#A80036" points="1025,850.75,1015,854.75,1025,858.75,1021,854.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1021" y="836.6841">vc_gen_ctx-&gt;w = w</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1056" y1="888.8828" y2="888.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1056" x2="1056" y1="888.8828" y2="901.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1056" y1="901.8828" y2="901.8828"/><polygon fill="#A80036" points="1019,897.8828,1009,901.8828,1019,905.8828,1015,901.8828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1021" y="883.8169">return *vc_genctx</text><polygon fill="#A80036" points="620,922.0156,610,926.0156,620,930.0156,616,926.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="614" x2="1008" y1="926.0156" y2="926.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="626" y="920.9497">return</text><polygon fill="#A80036" points="346,985.8477,336,989.8477,346,993.8477,342,989.8477" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="603" y1="989.8477" y2="989.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="352" y="984.7817">return</text><path d="M23,946.0156 L23,1016.0156 L326,1016.0156 L326,956.0156 L316,946.0156 L23,946.0156 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M316,946.0156 L316,956.0156 L326,956.0156 L316,946.0156 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="29" y="963.0825">now the evp_pkey_ctx holds the *vc_genctx</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="29" y="978.2153">that contains a handle to the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="29" y="993.3481">wallet to generate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="29" y="1008.481">a DID and VC</text><path d="M553,1037.5469 L553,1062.5469 L1060,1062.5469 L1060,1047.5469 L1050,1037.5469 L553,1037.5469 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1050,1037.5469 L1050,1047.5469 L1060,1047.5469 L1050,1037.5469 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="399" x="600.5" y="1054.6138">We can now generate a DID (private key) and a VC (public key)</text><path d="M61,1078.6797 L274,1078.6797 L274,1085.6797 L264,1095.6797 L61,1095.6797 L61,1078.6797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="447.9922" style="stroke: #000000; stroke-width: 2.0;" width="1367.5" x="61" y="1078.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="76" y="1091.7466">EVP_PKEY *VC CREATE</text><polygon fill="#A80036" points="592,1112.9453,602,1116.9453,592,1120.9453,596,1116.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="598" y1="1116.9453" y2="1116.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="342" y="1111.8794">EVP_PKEY_keygen(*evp_pkey_ctx)</text><path d="M546,1131.9453 L674,1131.9453 L674,1138.9453 L664,1148.9453 L546,1148.9453 L546,1131.9453 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="318.3281" style="stroke: #000000; stroke-width: 2.0;" width="872.5" x="546" y="1131.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="561" y="1145.0122">KMGMT_OP</text><polygon fill="#A80036" points="997,1166.2109,1007,1170.2109,997,1174.2109,1001,1170.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604" x2="1003" y1="1170.2109" y2="1170.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="611" y="1165.145">vc_gen(evp_pkey_ctx-&gt;vc_kmgmt-&gt;vc_genctx)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1051" y1="1199.3438" y2="1199.3438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1051" x2="1051" y1="1199.3438" y2="1212.3438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010" x2="1051" y1="1212.3438" y2="1212.3438"/><polygon fill="#A80036" points="1020,1208.3438,1010,1212.3438,1020,1216.3438,1016,1212.3438" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="1016" y="1194.2778">i = malloc(Identity)</text><polygon fill="#A80036" points="1314,1237.4766,1324,1241.4766,1314,1245.4766,1318,1241.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1320" y1="1241.4766" y2="1241.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="1016" y="1236.4106">did_create(vc_genctx-&gt;w)</text><polygon fill="#A80036" points="1020,1266.6094,1010,1270.6094,1020,1274.6094,1016,1270.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1325" y1="1270.6094" y2="1270.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="1026" y="1265.5435">return *did</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1051" y1="1299.7422" y2="1299.7422"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1051" x2="1051" y1="1299.7422" y2="1312.7422"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010" x2="1051" y1="1312.7422" y2="1312.7422"/><polygon fill="#A80036" points="1020,1308.7422,1010,1312.7422,1020,1316.7422,1016,1312.7422" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1016" y="1294.6763">i-&gt;did = did</text><polygon fill="#A80036" points="1314,1337.875,1324,1341.875,1314,1345.875,1318,1341.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1320" y1="1341.875" y2="1341.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="1016" y="1336.8091">vc_create(vc_genctx-&gt;w)</text><polygon fill="#A80036" points="1020,1367.0078,1010,1371.0078,1020,1375.0078,1016,1371.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1014" x2="1325" y1="1371.0078" y2="1371.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="1026" y="1365.9419">return *vc</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1051" y1="1400.1406" y2="1400.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1051" x2="1051" y1="1400.1406" y2="1413.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010" x2="1051" y1="1413.1406" y2="1413.1406"/><polygon fill="#A80036" points="1020,1409.1406,1010,1413.1406,1020,1417.1406,1016,1413.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="1016" y="1395.0747">i-&gt;vc = vc</text><polygon fill="#A80036" points="615,1438.2734,605,1442.2734,615,1446.2734,611,1442.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="1008" y1="1442.2734" y2="1442.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="621" y="1437.2075">return *i;</text><polygon fill="#A80036" points="346,1494.5391,336,1498.5391,346,1502.5391,342,1498.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="603" y1="1498.5391" y2="1498.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="352" y="1493.4731">return EVP_PKEY *vc</text><path d="M71,1462.2734 L71,1517.2734 L326,1517.2734 L326,1472.2734 L316,1462.2734 L71,1462.2734 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M316,1462.2734 L316,1472.2734 L326,1472.2734 L316,1462.2734 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="77" y="1479.3403">Now I generated a keypair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="77" y="1494.4731">(DID *privatekey and VC* publickey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="77" y="1509.606">that I have stored in EVP_PKEY *vc</text><path d="M449,1538.6719 L449,1563.6719 L1159,1563.6719 L1159,1548.6719 L1149,1538.6719 L449,1538.6719 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1149,1538.6719 L1149,1548.6719 L1159,1548.6719 L1149,1538.6719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="689" x="455" y="1555.7388">We now encode our VC and DID Document (+ fragment) in PEM format and write them on two separate files</text><path d="M283,1579.8047 L535,1579.8047 L535,1586.8047 L525,1596.8047 L283,1596.8047 L283,1579.8047 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="336.1953" style="stroke: #000000; stroke-width: 2.0;" width="1077" x="283" y="1579.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="298" y="1592.8716">PEM ENCODE of DID and VC</text><polygon fill="#A80036" points="592,1614.0703,602,1618.0703,592,1622.0703,596,1618.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="598" y1="1618.0703" y2="1618.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="342" y="1613.0044">PEM_write_bio_PrivateKey(*vc)</text><path d="M546,1633.0703 L680,1633.0703 L680,1640.0703 L670,1650.0703 L546,1650.0703 L546,1633.0703 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="102.3984" style="stroke: #000000; stroke-width: 2.0;" width="804" x="546" y="1633.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="561" y="1646.1372">ENCODE_OP</text><polygon fill="#A80036" points="997,1667.3359,1007,1671.3359,997,1675.3359,1001,1671.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604" x2="1003" y1="1671.3359" y2="1671.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="381" x="611" y="1666.27">vc_to_PrivateKeyInfo_pem_encode(*vc-&gt;kmgmt-&gt;keydata)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1051" y1="1700.4688" y2="1700.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1051" x2="1051" y1="1700.4688" y2="1713.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010" x2="1051" y1="1713.4688" y2="1713.4688"/><polygon fill="#A80036" points="1020,1709.4688,1010,1713.4688,1020,1717.4688,1016,1713.4688" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1016" y="1695.4028">PEM_write_BIO()</text><path d="M1131,1685.8359 L1131,1710.8359 L1331,1710.8359 L1331,1695.8359 L1321,1685.8359 L1131,1685.8359 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1321,1685.8359 L1321,1695.8359 L1331,1695.8359 L1321,1685.8359 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1137" y="1702.9028">Writes DID Document on file</text><polygon fill="#A80036" points="615,1723.4688,605,1727.4688,615,1731.4688,611,1727.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="1008" y1="1727.4688" y2="1727.4688"/><polygon fill="#A80036" points="346,1744.4688,336,1748.4688,346,1752.4688,342,1748.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="603" y1="1748.4688" y2="1748.4688"/><polygon fill="#A80036" points="592,1773.6016,602,1777.6016,592,1781.6016,596,1777.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="335" x2="598" y1="1777.6016" y2="1777.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="342" y="1772.5356">PEM_write_bio_PUBKEY(*vc)</text><path d="M546,1792.6016 L680,1792.6016 L680,1799.6016 L670,1809.6016 L546,1809.6016 L546,1792.6016 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="102.3984" style="stroke: #000000; stroke-width: 2.0;" width="728" x="546" y="1792.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="561" y="1805.6685">ENCODE_OP</text><polygon fill="#A80036" points="997,1826.8672,1007,1830.8672,997,1834.8672,1001,1830.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604" x2="1003" y1="1830.8672" y2="1830.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="611" y="1825.8013">vc_to_PublicKeyInfo_pem_encode(*vc-&gt;kmgmt-&gt;keydata)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1009" x2="1051" y1="1860" y2="1860"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1051" x2="1051" y1="1860" y2="1873"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010" x2="1051" y1="1873" y2="1873"/><polygon fill="#A80036" points="1020,1869,1010,1873,1020,1877,1016,1873" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1016" y="1854.9341">PEM_write_BIO()</text><path d="M1131,1845.3672 L1131,1870.3672 L1255,1870.3672 L1255,1855.3672 L1245,1845.3672 L1131,1845.3672 " fill="#FBFB77" filter="url(#fsfgj8hg35e4m)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1245,1845.3672 L1245,1855.3672 L1255,1855.3672 L1245,1845.3672 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1137" y="1862.4341">Writes VC on file</text><polygon fill="#A80036" points="615,1883,605,1887,615,1891,611,1887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="609" x2="1008" y1="1887" y2="1887"/><polygon fill="#A80036" points="346,1904,336,1908,346,1912,342,1908" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="603" y1="1908" y2="1908"/><!--MD5=[28f8be9febc8ca0ca52047e8869c6f65]
@startuml
participant GENPKEY as app
participant LIBCRYPTO as lcrypto
participant SSI_PROVIDER as prov
participant IDENTITY_CBINDINGS as id

group PROVIDER LOAD
app -> lcrypto: OSSL_PROVIDER_load()
activate lcrypto

lcrypto -> prov: OSSL_PROVIDER_init()
activate prov
prov -> id: prov_init_wallet()
activate id
id -> id: setup
id -> prov: return *wallet
deactivate id
prov -> lcrypto: return *provctx
note left: provctx is now stored in libctx which \ncan be accessed during the application
deactivate prov 
lcrypto -> app: return
deactivate lcrypto
end

note over lcrypto, prov: given the algorithm name (VC) we save into the EVP_PKEY_CTX the provider that contains this implemenation
group EVP_PKEY_CTX CREATE
app -> lcrypto: EVP_PKEY_CTX_new_from_name("VC")
activate lcrypto
lcrypto -> lcrypto: EVP_KEYMGMT_fetch()
lcrypto -> prov: ssi_query()
activate prov
prov -> lcrypto: return *vc_kmgmt
deactivate prov
lcrypto -> app: return *evp_pkey_ctx
deactivate lcrypto
note left: No we a have an EVP_PKEY_CTX that \ncontains the implementation of the \nVC algorithm
end

note over lcrypto, prov: We generate the VC_GEN_CTX in which we will store the Wallet that will be needed to generate a DID and a VC
group VC_GEN_CTX CREATE
app -> lcrypto: EVP_PKEY_gen_init(*evp_pkey_ctx)
activate lcrypto
group KMGMT_OP
lcrypto -> prov: gen_init(evp_pkey_ctx->vc_kmgmt)
activate prov
prov -> prov: vc_gen_ctx = malloc()
prov -> prov: w = prov_ctx_get_wallet(vc_kmgmt->provctx)
note right: extracts the wallet and saves it in vc_gen_ctx
prov -> prov: vc_gen_ctx->w = w
prov -> prov: return *vc_genctx
deactivate prov
prov -> lcrypto: return
end
lcrypto -> app: return
deactivate lcrypto
note left: now the evp_pkey_ctx holds the *vc_genctx \nthat contains a handle to the \nwallet to generate \na DID and VC
end

note over lcrypto, prov: We can now generate a DID (private key) and a VC (public key) 
group EVP_PKEY *VC CREATE
app -> lcrypto: EVP_PKEY_keygen(*evp_pkey_ctx)
group KMGMT_OP
lcrypto -> prov: vc_gen(evp_pkey_ctx->vc_kmgmt->vc_genctx)
prov -> prov: i = malloc(Identity)
prov -> id: did_create(vc_genctx->w)
id -> prov: return *did
prov -> prov: i->did = did
prov -> id: vc_create(vc_genctx->w)
id -> prov: return *vc
prov -> prov: i->vc = vc
prov -> lcrypto: return *i;
end
lcrypto -> app: return EVP_PKEY *vc
note left: Now I generated a keypair \n(DID *privatekey and VC* publickey) \nthat I have stored in EVP_PKEY *vc
end

note over lcrypto, prov: We now encode our VC and DID Document (+ fragment) in PEM format and write them on two separate files
group PEM ENCODE of DID and VC
app->lcrypto : PEM_write_bio_PrivateKey(*vc)
group ENCODE_OP
lcrypto -> prov: vc_to_PrivateKeyInfo_pem_encode(*vc->kmgmt->keydata)
prov -> prov : PEM_write_BIO()
note right: Writes DID Document on file
prov -> lcrypto:
end
lcrypto -> app: 

app->lcrypto : PEM_write_bio_PUBKEY(*vc)
group ENCODE_OP
lcrypto -> prov: vc_to_PublicKeyInfo_pem_encode(*vc->kmgmt->keydata)
prov -> prov : PEM_write_BIO()
note right: Writes VC on file
prov -> lcrypto:
end
lcrypto -> app:
end

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.21+9-post-Ubuntu-0ubuntu122.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>